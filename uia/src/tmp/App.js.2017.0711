import React, { Component } from 'react';
//import logo from './logo.svg';
import './App.css';

import ListEditor from './title.description/list.editor.js';

import {TitleDescription} from './title.description/td.js';
import Sublist from './title.description/sub.list.js';
import TopListor from './title.description/top.list.js';
//import TestOneRec from './title.description/one.rec.js';
import TopAndSub from './title.description/top.and.sub.js';
import {AddTitleDescription} from './title.description/add.td.js';

import {ButMenu} from './menu.button/but.js';


const p = console.log;


class App extends Component {

    constructor(props) {
        super(props);

        this.state = {
            showWhat: 'listTopRec',
            //oneid: 'the id of the top record to be shown up'
        };

        this.jsonurl = "/20less";

        this.data = null;
        //this.top  = null;
        //this.subs = null;

        setTimeout(this.fetchData, 10);
    }

    fetchData = ()=>{
        //console.log(this.jsonurl);
        this.data = null;
        fetch(this.jsonurl).then((response) =>{
            return response.json();
        }).then((j)=>{
            //console.log('json? ', j);
            this.data = j;
            this.setState({'fetched': true});

            //console.log(j);

        });
    }


    renderDoingFetching(){
        return (
                <div className="App">
                <p className="App-intro">
                     doing data fetching
                </p>
                </div>
               );

    }


    passBackOneId = (sid)=>{
        this.setState({showWhat: 'OneRecWithID', oneid: sid});
    }


    testTitleDescription(){
        p('test title description ', this.data.top);

        //let data={
        //    text: 'in test input text',
        //};
        let opt={
            showForm: false,
        };
        return (
                <TitleDescription data={this.data.top} opt={opt} />
               );
    }

    renderNormal() {
        return (
                <div className="App">

                    <div className="testTitleDescription">
                        {this.testTitleDescription()}
                    </div>

                    <br />
                    <hr  />
                    <br />

                    <div className="subs">
                        <Sublist data={this.data.subs} />
                    </div>





                    {/*
                    <div className="my0625">
                        <p> place holder for list editor </p>
                        <ListEditor data={this.data} />
                    </div>
                    */}

                </div>
               );
    }

    listTopRec = ()=>{
        //e.preventDefault();

        //this.setState({showWhat: 'ListTopRec'});
        return (
                <p>
                list top rec 0702 0904am
                <TopListor passBackOneId={this.passBackOneId} />
                </p>
        );

    }


    switchRender (){
        switch(this.state.showWhat){
            case 'ListTopRec':
                return this.listTopRec();
                break;

            case 'AddNew':
                return <AddTitleDescription />;
                break;

            //case 'TestOneRec':
            //    return <TestOneRec />;
            //    break;

            case 'OneRecWithID': //todo
                return <TopAndSub oneid={this.state.oneid} />;
                break;

            default:
                return ''; // empty string
        }
    }


    render(){
        return (
            <div className="App">
                <form className="chooser">
                    <ButMenu /> 

                    <button type="button" 
                        onClick={(e)=>{this.setState({showWhat:'ListTopRec'})}}>
                        List Value Records
                    </button>

                    <button type="button"
                        onClick={(e)=>{this.setState({showWhat:'AddNew'})}}>
                    >
                    Add Value Records </button>

                    {/*
                    <button type="button"
                        onClick={(e)=>{this.setState({showWhat:'TestOneRec'})}}>
                    >
                    show One top Value </button>
                    */}
                </form>

                {this.switchRender()}
            </div>
        );
    }
}

export default App;
